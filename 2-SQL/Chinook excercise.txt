-- basic exercises (Chinook database)

-- 1. list all customers (full names, customer ID, and country) who are not in the US
SELECT Customer.Firstname, Customer.LastName, Customer.CustomerId, Customer.Country FROM Customer WHERE Country != 'USA';

-- 2. list all customers from brazil
SELECT Customer.Firstname, Customer.LastName, Customer.CustomerId, Customer.Country FROM Customer WHERE Country = 'Brazil';

-- 3. list all sales agents
SELECT * FROM Employee WHERE Title = 'Sales Support Agent';

-- 4. show a list of all countries in billing addresses on invoices.
SELECT BillingCountry FROM Invoice;

-- 5. how many invoices were there in 2009, and what was the sales total for that year?
--    (extra challenge: find the invoice count sales total for every year, using one query)
SELECT * FROM Invoice WHERE YEAR (InvoiceDate) = '2009';
SELECT YEAR (InvoiceDate) AS 'Year', COUNT(*) AS 'Total Sales' FROM Invoice GROUP BY YEAR(InvoiceDate);

-- 6. how many line items were there for invoice #37?
SELECT SUM(Quantity) AS 'Line Items' FROM InvoiceLine WHERE InvoiceId = '37';

-- 7. how many invoices per country?
SELECT BillingCountry AS 'Country', COUNT(*) AS 'Invoices' FROM Invoice GROUP BY BillingCountry;

-- 8. show total sales per country, ordered by highest sales first.
SELECT BillingCountry AS 'Country', COUNT(*) AS 'Invoices' FROM Invoice GROUP BY BillingCountry ORDER BY SUM(Total) DESC;

------------------------------------------------------------------------------------------------------


-- join exercises (Chinook database)
-- 1. show all invoices of customers from brazil (mailing address not billing)


-- 2. show all invoices together with the name of the sales agent of each one
-- 3. show all playlists ordered by the total number of tracks they have
-- 4. which sales agent made the most in sales in 2009?
-- 5. how many customers are assigned to each sales agent?
-- 6. which track was purchased the most since 2010?
-- 7. show the top three best-selling artists.
-- 8. which customers have the same initials as at least one other customer?

------------------------------------------------------------------------------------------------------


-- exercises
-- solve these with a mixture of joins, subqueries, CTE, and set operators.
-- solve at least one of them in two different ways, and see if the execution
-- plan for them is the same, or different.
-- 1. which artists did not make any albums at all?
-- 2. which artists did not record any tracks of the Latin genre?
-- join version
-- 3. which video track has the longest length? (use media type table)
-- 4. find the names of the customers who live in the same city as the
--    boss employee (the one who reports to nobody)
-- 5. how many audio tracks were bought by German customers, and what was
--    the total price paid for them?
-- 6. list the names and countries of the customers supported by an employee
--    who was hired younger than 35.

------------------------------------------------------------------------------------------------------
-- DML Exercises

-- 1. insert two new records into the employee table.
INSERT INTO Employee (EmployeeId, FirstName, LastName) VALUES (9, 'Kirti', 'Patel'), (10, 'Yash', 'Patel');

-- 2. insert two new records into the tracks table.
INSERT INTO Track (TrackId, Name, AlbumId, MediaTypeId, GenreId, Composer, Milliseconds, Bytes, UnitPrice) 
VALUES (4000, 'Bollywood', 3, 3, 3, 'Kirti', 34567, 5678, 100), (5000, 'LOL', 4, 4, 4, 'Yash', 45678, 6789, 100);

-- 3. update customer Aaron Mitchell's name to Robert Walter
UPDATE Customer
	SET FirstName = 'Robert', LastName = 'Walter'  -- Without WHERE, would modify every row
		WHERE CustomerId = 32;

-- 4. delete one of the employees you inserted.
DELETE FROM Employee
		WHERE EmployeeId = 10;

-- 5. delete customer Robert Walter.
